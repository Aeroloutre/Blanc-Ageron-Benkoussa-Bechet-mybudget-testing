<div class="categories-container">
  <h1>Mes Catégories de Budget</h1>
  
  <div *ngIf="loading" class="loading-message">
    <p>Chargement des catégories...</p>
  </div>

  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button (click)="loadCategories()">Réessayer</button>
  </div>
  
  <div class="categories-grid" *ngIf="!loading && !error">
    <div class="category-card" *ngFor="let category of categories" (click)="seeDetails(category.category_id!)">
      <button class="btn-delete" (click)="deleteCategory(category.category_id!, $event)" title="Supprimer la catégorie">
        <img src="fermer.png" alt="Supprimer" />
      </button>
      <h3>{{ category.label }}</h3>
      <div class="category-info">
        <p><small>Créée le: {{ category.created_at | date:'short' }}</small></p>
      </div>
      
      <div class="budgets-section" *ngIf="getBudgetsForCategory(category.category_id!).length > 0">
        <h4>Budgets associés:</h4>
        <div class="budget-item" *ngFor="let budget of getBudgetsForCategory(category.category_id!)">
          <p><strong>{{ budget.allocated_amount }}€</strong></p>
          <p><small>{{ budget.period_start | date:'short' }} - {{ budget.period_end | date:'short' }}</small></p>
        </div>
      </div>
    </div>

    <div *ngIf="categories.length === 0" class="no-categories">
      <p>Aucune catégorie pour le moment.</p>
      <p>Commencez par en ajouter une !</p>
    </div>
  </div>
  
  <button class="btn-ajouter" (click)="addCategory()" [disabled]="loading">+ Ajouter une catégorie</button>
</div>
